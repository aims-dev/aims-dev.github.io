---
layout: post
title: MQTT(Message Queuing Telemetry Transport)
name: 김영한 
reg_date: 2020년 11월 26일
featured-img: MQTT_protocol_QoS0
---
안녕하세요? 저는 에임스에서 백엔드 개발 업무를 맡고 있는 김영한 연구원입니다. 
에임스로 이직 후 처음으로 맡게 된 프로젝트에서 MQTT 프로토콜을 알게 됐는데, 
HTTP에 익숙하던 터라 처음 MQTT 프로토콜을 이해하는 데에 어려움이 있었습니다. 
그래서 MQTT 프로토콜을 이해하는 데에 필요한 개념들에 대해서 정리하려고 합니다.

## MQTT란?
먼저 위키피디아에 있는 MQTT의 정의를 살펴보겠습니다.

```
MQTT(메시지 큐잉 텔레메트리 트랜스포트, Message Queuing Telemetry Transport)는 ISO 표준(ISO/IEC PRF 20922) 발행-구독 기반의 메시징 프로토콜이다. 
TCP/IP 프로토콜 위에서 동작한다. "작은 코드 공간"(small code footprint)이 필요하거나 네트워크 대역폭이 제한되는 원격 위치와의 연결을 위해 설계되어 있다. 발행-구독 메시징 패턴은 메시지 브로커가 필요하다.  
```

위 정의에서 MQTT를 이해하기 위해 알아야 할 주요 개념은 '메시지 큐', '발행 - 구독 메시징 패턴', '브로커'입니다.
세 개념에 대해 살펴보도록 하겠습니다.

## 메시지 큐란?
![message-queue](https://i1.wp.com/codeblog.dotsandbrackets.com/wp-content/uploads/2016/10/async-comm.jpg?resize=603%2C296&ssl=1)

메시지 발행 클라이언트와 메시지 소비 클라이언트의 중개자 역할을 하게 됨으로써 
마이크로서비스의 특징인 ‘비동기성’, ‘느슨한 결합’, ‘유연성’, ‘확장성’을 제공하게 된다.

```
① 비동기성(Asynchronous): Queue에 넣기 때문에 나중에 처리할 수 있다.

② 느슨한 결합(Decoupling): 애플리케이션과 분리할 수 있다.

③ 유연성(Resilience): 일부가 실패 시 전체에 영향을 받지 않는다.

④ 확장성(Scalable): 다수의 프로세스들이 큐에 메시지를 보낼 수 있다.
```

## 발행-구독 메시징 패턴 && 브로커란?
![pub-sub-message-pattern](https://docs.microsoft.com/ko-kr/azure/architecture/patterns/_images/publish-subscribe.png)

### 발행-구독 메시징 패턴
발행-구독 모델은 비동기 메시징 패러다임이다. 
발행-구독 모델에서 발신자의 메시지는 특별한 수신자가 정해져 있지 않다. 
대신 발행된 메시지는 정해진 토픽에 따라, 각 토픽에 대한 구독을 신청한 수신자에게 전달된다. 
수신자는 발행자에 대한 지식이 없어도 원하는 메시지만을 수신할 수 있다. 
이러한 발행자와 구독자의 디커플링은 더 다이나믹한 네트워크 토폴로지와 높은 확장성을 허용한다.

### 브로커
메시지 브로커(message broker), 인터페이스 엔진(interface engine)은 
송신자의 이전 메시지 프로토콜로부터의 메시지를 수신자의 이전 메시지 프로토콜로 변환하는 
중간 컴퓨터 프로그램 모듈이다.

## QoS란?
![qos0](https://miro.medium.com/max/1400/0*1NSybQWdhHvVhnTb.png)
![qos1](https://miro.medium.com/max/1400/0*b4pvXUWp6MVnAAFy.png)
![qos2](https://miro.medium.com/max/1400/0*G6zwc_VftJ4AcueS.png)
추가적으로 MQTT 프로토콜의 QoS에 대해 알아보겠습니다.

## 참조 및 출처 사이트

---
다음 작성자는 <font color='#FFFFFF'>저희 소프트웨어 책임 연구원이신 김병규 책임 연구원</font>입니다.


